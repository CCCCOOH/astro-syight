---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import { get_title, format_say_date } from "../scripts/utils";
import { info } from "../config/says.js"
import { date_sort } from "../scripts/utils"
import ImagesGallery from "../components/ImagesGallery.astro";
const says = date_sort(await getCollection('says')); 
function avatar_style(say) {
  return `background-image: url(${say.data?.avatar || info.avatar});`;
}
const pageTitle = "says";
---

<BaseLayout pageTitle={pageTitle}>
  <div class="flex justify-center items-center mt-10 back-grid">
    <ul class="w-[50vw] py-2">
      {
        says.map(say => 
        <li class="born">
          <aside class="flex pb-5">
            {/* 头像 */}
            <div style={avatar_style(say)} class="bg-cover size-20 rounded"></div>
            <div class="pl-5 flex flex-col justify-center">
              {/* 作者名 */}
              <span class="author-name text-xl! font-mono! text-slate-800">{say.data?.author || info.author}</span>
              {/* 描述 */}
              <span class="description text-sm! font-mono text-slate-500">{say.data?.description || info.description}</span>
            </div>
          </aside>
          <h1 class="m-0! text-2xl!">{say.data?.title || get_title(say)}</h1>
          <p class="text-base!">{say.body}</p>
          <div class="flex justify-center">
          <div class="py-5">
            <ImagesGallery img_width={say.data?.img_width} height={say.data?.height} radius={say.data?.radius} photos={say.data?.photos} />
          </div>
          </div>
          <!-- 日期 -->
          <div class="date text-slate-500 text-center">Date: {format_say_date(say.data?.date)}</div>
        </li>)
      }
    </ul>
  </div>
  
</BaseLayout>

<style>
  li::before {
    content: none;
  }
  :global(.dark) .author-name {
    color: var(--color-slate-100);
  }
  :global(.dark) .description {
    color: var(--color-slate-400);
  }
  :global(.dark) .date {
    color: var(--color-slate-400);
  }
</style>